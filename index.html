<!DOCTYPE HTML>
<html lang="en">
    <head>
        <meta charset="UTF-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1"/>
        <meta name="theme-color" content="#252525"/>
        <title>Upupa Bird Ninja</title>
        <style>
            body {
                margin: 0;
                font-family: Inter, sans-serif;
                background-color: #252525;
                background-image: url(https://img.itch.zone/aW1nLzE3MjY2NjA0LmpwZw==/original/RcoHTc.jpg);
                background-repeat: repeat-x;
                background-position: center;
                background-attachment: fixed;
                color: #ffffff;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                min-height: 100vh;
            }
            .game_frame {
                width: 100%;
                max-width: 960px;
                height: calc(100vw * 0.625); /* Maintain 16:10 aspect ratio */
                max-height: 600px;
                background-color: #2b2b2b;
                position: relative;
            }
            .fullscreen_btn {
                position: absolute;
                top: 10px;
                right: 10px;
                background: none;
                border: none;
                cursor: pointer;
            }
            .fullscreen_btn img {
                width: 24px;
                height: 24px;
            }
            .wallet_icon {
                position: absolute;
                bottom: 34px;
                left: 34px;
                width: 250px;
                height: 39px;
                cursor: pointer;
                transition: opacity 1s ease-in-out;
            }
            .wallet_icon.hidden {
                animation: fadeOut 1s forwards; /* 使用动画隐藏图标 */
            }
            @keyframes fadeOut {
                from {
                    opacity: 1;
                }
                to {
                    opacity: 0;
                }
            }
            .description {
                padding: 40px 20px;
                text-align: center;
                font-size: 1rem;
                background-color: #2b2b2b;
                color: #ffffff;
                width: 100%;
                max-width: 960px;
                box-sizing: border-box;
            }
            .description h1 {
                margin: 0;
                font-size: 2rem;
                font-weight: bold;
                text-transform: uppercase;
            }
            .description img {
                margin-top: 20px;
                width: 100px;
                height: 65px;
                cursor: pointer;
            }
            iframe {
                width: 100%;
                height: 100%;
                border: none;
            }
            .wallet_address {
                margin-top: 10px;
                color: #00ff00;
                font-size: 1rem;
            }
        </style>
    </head>
    <body>
        <div class="game_frame">
            <button title="Enter fullscreen" class="fullscreen_btn">
                <img src="https://itch.io/static/images/enlarge.svg?1734309005" alt="Fullscreen"/>
            </button>
            <img src="https://via.placeholder.com/50" alt="Wallet" class="wallet_icon" id="walletIcon"/>
            <iframe
                id="unity-canvas"
                src="https://html-classic.itch.zone/html/12246759/index.html"
                allow="autoplay; fullscreen *; geolocation; microphone; camera; midi; monetization; xr-spatial-tracking; gamepad; gyroscope; accelerometer; xr; cross-origin-isolated; web-share"
                allowfullscreen>
            </iframe>
        </div>
        <div class="description">
            <h1>GAME</h1>
            <p>
                Slice through hordes of enemies as you navigate Upupa the hoopoe through their final trial to bring light to the top of the tower and keep evil at bay for another generation. Upupa Bird Ninja is a fast-paced tough-as-talons adventure.
            </p>
            <p><em>Note: plays best with mouse or controller. Touch input not fully supported.</em></p>
            <a href="https://example.com" target="_blank">
                <img src="https://via.placeholder.com/100x65" alt="Link Image" />
            </a>
            <p id="walletAddress" class="wallet_address"></p>
        </div>

        <script>
            // 钱包连接逻辑
            document.getElementById('walletIcon').addEventListener('click', async () => {
                if (!window.solana || !window.solana.isPhantom) {
                    alert('Phantom wallet not detected. Please install it from the Chrome Web Store.');
                    return;
                }

                try {
                    const response = await window.solana.connect();
                    const publicKey = response.publicKey.toString();
                    const message = 'Sign this message to confirm your wallet address.';
                    const encodedMessage = new TextEncoder().encode(message);
                    const signedMessage = await window.solana.signMessage(encodedMessage, 'utf8');

                    document.getElementById('walletAddress').innerText = `Wallet Address: ${publicKey}`;
                } catch (error) {
                    console.error('Error during wallet connection:', error);
                    alert('Wallet connection failed.');
                }
            });

            // 监听游戏窗口点击事件
            document.querySelector('#unity-canvas').addEventListener('click', () => {
                const walletIcon = document.getElementById('walletIcon'); // 选择钱包图标
                walletIcon.classList.add('hidden'); // 添加隐藏动画类
                setTimeout(() => {
                    walletIcon.style.display = 'none'; // 动画结束后彻底隐藏
                }, 1000); // 1秒对应CSS动画时间
                console.log('Wallet icon fading out after canvas click');
            });
        </script>
    </body>
</html>
