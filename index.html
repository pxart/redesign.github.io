<!DOCTYPE HTML>
<html lang="en">
    <head>
        <meta charset="UTF-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1"/>
        <meta name="theme-color" content="#252525"/>
        <title>Wallet Integration</title>
        <style>
            body {
                margin: 0;
                font-family: Arial, sans-serif;
                background-color: #252525;
                color: #ffffff;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                min-height: 100vh;
            }
            .wallet-selector {
                margin: 20px;
            }
            .wallet-info {
                margin-top: 20px;
                color: #ffffff;
                font-size: 1rem;
            }
            .game_frame {
                width: 100%;
                max-width: 960px;
                height: 400px;
                background-color: #2b2b2b;
                display: flex;
                align-items: center;
                justify-content: center;
                pointer-events: none;
            }
        </style>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/@solana/web3.js/1.75.0/web3.min.js"></script>
        <script src="https://static.okx.com/cdn-wallet-sdk/okxwallet.min.js"></script>
        <script>
            let walletConnected = false;
            let walletAddress = "";

            // Phantom Wallet (Solana)
            async function connectPhantomWallet() {
                try {
                    if (!window.solana) {
                        alert("Phantom wallet not found. Please install it first.");
                        return;
                    }
                    const response = await window.solana.connect();
                    walletAddress = response.publicKey.toString();

                    const message = "Sign this message to confirm wallet connection.";
                    const encodedMessage = new TextEncoder().encode(message);
                    const signedMessage = await window.solana.request({
                        method: "signMessage",
                        params: {
                            message: encodedMessage,
                            display: "utf8",
                        },
                    });

                    alert(`Phantom Wallet connected. Signature: ${signedMessage.signature}`);
                    walletConnected = true;
                    updateWalletInfo();
                } catch (error) {
                    console.error("Phantom Wallet connection failed:", error);
                    alert("Failed to connect Phantom Wallet.");
                }
            }

            // OKX Wallet
            async function connectOKXWallet() {
                try {
                    const okxWallet = window.okxwallet;
                    if (!okxWallet) {
                        alert("OKX wallet not found. Please install it first.");
                        return;
                    }

                    const accounts = await okxWallet.requestAccounts();
                    walletAddress = accounts[0];

                    const message = "Sign this message to confirm wallet connection.";
                    const signedMessage = await okxWallet.signMessage({
                        address: walletAddress,
                        message,
                    });

                    alert(`OKX Wallet connected. Signature: ${signedMessage}`);
                    walletConnected = true;
                    updateWalletInfo();
                } catch (error) {
                    console.error("OKX Wallet connection failed:", error);
                    alert("Failed to connect OKX Wallet.");
                }
            }

            // Trust Wallet (Ethereum)
            async function connectTrustWallet() {
                try {
                    if (!window.ethereum) {
                        alert("Trust Wallet not found. Please install it first.");
                        return;
                    }

                    const accounts = await window.ethereum.request({
                        method: "eth_requestAccounts",
                    });
                    walletAddress = accounts[0];

                    const message = "Sign this message to confirm wallet connection.";
                    const from = walletAddress;
                    const params = [message, from];
                    const method = "personal_sign";

                    const signature = await window.ethereum.request({
                        method,
                        params,
                        from,
                    });

                    alert(`Trust Wallet connected. Signature: ${signature}`);
                    walletConnected = true;
                    updateWalletInfo();
                } catch (error) {
                    console.error("Trust Wallet connection failed:", error);
                    alert("Failed to connect Trust Wallet.");
                }
            }

            // Update Wallet Info on UI
            function updateWalletInfo() {
                document.getElementById("wallet-info").innerText = `Wallet Address: ${walletAddress}`;
                document.querySelector(".game_frame").style.pointerEvents = "auto";
            }

            // Wallet Selector Event
            function connectWallet(walletType) {
                switch (walletType) {
                    case "phantom":
                        connectPhantomWallet();
                        break;
                    case "okx":
                        connectOKXWallet();
                        break;
                    case "trust":
                        connectTrustWallet();
                        break;
                    default:
                        alert("Invalid wallet type selected.");
                }
            }
        </script>
    </head>
    <body>
        <h1>Wallet Integration Demo</h1>
        <div class="wallet-selector">
            <label for="wallet-select">Choose Wallet:</label>
            <select id="wallet-select" onchange="connectWallet(this.value)">
                <option value="">Select...</option>
                <option value="phantom">Phantom Wallet</option>
                <option value="okx">OKX Wallet</option>
                <option value="trust">Trust Wallet</option>
            </select>
        </div>
        <div id="wallet-info" class="wallet-info"></div>
        <div class="game_frame">
            <p>Game content will unlock after wallet connection.</p>
        </div>
    </body>
</html>
